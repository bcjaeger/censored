<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="censored">
<title>Fitting and Predicting with censored • censored</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../../deps/_Source%20Sans%20Pro-0.4.0/font.css" rel="stylesheet">
<link href="../../deps/_Source%20Code%20Pro-0.4.0/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Fitting and Predicting with censored">
<meta property="og:description" content="censored">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-none"><div class="container">
    <a class="navbar-brand me-2" href="../../index.html">censored</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../../articles/articles/examples.html">Fitting and Predicting with censored</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tidymodels/censored/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
  </div>
</nav><div class="container template-article" id="container">
<script src="examples_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
      <img src="" class="logo" alt=""><h1>Fitting and Predicting with censored</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/censored/blob/HEAD/vignettes/articles/examples.Rmd" class="external-link"><code>vignettes/articles/examples.Rmd</code></a></small>
      <div class="d-none name"><code>examples.Rmd</code></div>
    </div>

    
    
<p>These examples illustrate which models, engines, and prediction types are available in censored. As a reminder, in parsnip,</p>
<ul>
<li><p>the <strong>model type</strong> differentiates basic modeling approaches, such as random forests, proportional hazards models, etc.,</p></li>
<li><p>the <strong>mode</strong> denotes in what kind of modeling context it will be used (here, censored regression), and</p></li>
<li><p>the computational <strong>engine</strong> indicates how the model is fit, such as with a specific R package implementation or even methods outside of R like Keras or Stan.</p></li>
</ul>
<p>The following examples use the same data set throughout.</p>
<div class="section level2">
<h2 id="bag_tree-models">
<code>bag_tree()</code> models<a class="anchor" aria-label="anchor" href="#bag_tree-models"></a>
</h2>
<details id="bag-tree-rpart"><p><summary>With the <code>"rpart"</code> engine</summary></p>
<p>We’ll model the survival of lung cancer patients.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Registered S3 method overwritten by 'tune':</span>
  <span class="co">##   method                   from   </span>
  <span class="co">##   required_pkgs.model_spec parsnip</span></code></pre>
<pre><code><span class="co">## ── <span style="font-weight: bold;">Attaching packages</span> ──────────────────────────────── tidymodels 0.1.4 ──</span></code></pre>
<pre><code><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">broom       </span> 0.7.10         <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">rsample     </span> 0.1.1     </span>
  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dials       </span> 0.0.10         <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble      </span> 3.1.6     </span>
  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr       </span> 1.0.7          <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr       </span> 1.1.4     </span>
  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">infer       </span> 1.0.0          <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tune        </span> 0.1.6     </span>
  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">modeldata   </span> 0.1.1          <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">workflows   </span> 0.2.4     </span>
  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">parsnip     </span> 0.1.7.<span style="color: #BB0000;">9002</span>     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">workflowsets</span> 0.1.0     </span>
  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr       </span> 0.3.4          <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">yardstick   </span> 0.0.9     </span>
  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">recipes     </span> 0.1.17</span></code></pre>
<pre><code><span class="co">## ── <span style="font-weight: bold;">Conflicts</span> ─────────────────────────────────── tidymodels_conflicts() ──</span>
  <span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">purrr</span>::<span style="color: #00BB00;">discard()</span> masks <span style="color: #0000BB;">scales</span>::discard()</span>
  <span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span>  masks <span style="color: #0000BB;">stats</span>::filter()</span>
  <span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>     masks <span style="color: #0000BB;">stats</span>::lag()</span>
  <span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">recipes</span>::<span style="color: #00BB00;">step()</span>  masks <span style="color: #0000BB;">stats</span>::step()</span>
  <span class="co">## <span style="color: #0000BB;">•</span> Dig deeper into tidy modeling with R at <span style="color: #00BB00;">https://www.tmwr.org</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/censored" class="external-link">censored</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Loading required package: survival</span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span>
  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">)</span>
  
  <span class="va">lung</span> <span class="op">&lt;-</span> <span class="va">lung</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">lung_train</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="op">]</span>
  <span class="va">lung_test</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">bt_spec</span> <span class="op">&lt;-</span> 
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/bag_tree.html" class="external-link">bag_tree</a></span><span class="op">(</span>cost_complexity <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html" class="external-link">set_engine</a></span><span class="op">(</span><span class="st">"rpart"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_args.html" class="external-link">set_mode</a></span><span class="op">(</span><span class="st">"censored regression"</span><span class="op">)</span> 
  <span class="va">bt_spec</span></code></pre></div>
<pre><code><span class="co">## Bagged Decision Tree Model Specification (censored regression)</span>
  <span class="co">## </span>
  <span class="co">## Main Arguments:</span>
  <span class="co">##   cost_complexity = 0</span>
  <span class="co">##   min_n = 2</span>
  <span class="co">## </span>
  <span class="co">## Computational engine: rpart</span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="va">bt_fit</span> <span class="op">&lt;-</span> <span class="va">bt_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">lung_train</span><span class="op">)</span>
  <span class="va">bt_fit</span></code></pre></div>
<pre><code><span class="co">## parsnip model object</span>
  <span class="co">## </span>
  <span class="co">## Fit time:  109ms </span>
  <span class="co">## </span>
  <span class="co">## Bagging survival trees with 25 bootstrap replications </span>
  <span class="co">## </span>
  <span class="co">## Call: bagging.data.frame(formula = Surv(time, status) ~ ., data = data)</span></code></pre>
<p>The holdout data can be predicted for survival probability at different time points as well as event time.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>
    <span class="va">bt_fit</span>, 
    <span class="va">lung_test</span>, 
    type <span class="op">=</span> <span class="st">"survival"</span>, 
    time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">500</span>, <span class="fl">1000</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">.pred</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 3 × 2</span></span>
  <span class="co">##   .time .pred_survival</span>
  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>   100        0.946  </span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>   500        0.333  </span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>000        0.004<span style="text-decoration: underline;">96</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bt_fit</span>, <span class="va">lung_test</span>, type <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 5 × 1</span></span>
  <span class="co">##   .pred_time</span>
  <span class="co">##        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>        353</span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>        293</span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>        230</span>
  <span class="co">## <span style="color: #BCBCBC;">4</span>        201</span>
  <span class="co">## <span style="color: #BCBCBC;">5</span>        268</span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="boost_tree-models">
<code>boost_tree()</code> models<a class="anchor" aria-label="anchor" href="#boost_tree-models"></a>
</h2>
<details id="boost-tree-mboost"><p><summary>With the <code>"mboost"</code> engine</summary></p>
<p>We’ll model the survival of lung cancer patients.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/censored" class="external-link">censored</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span>
  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">)</span>
  
  <span class="va">lung</span> <span class="op">&lt;-</span> <span class="va">lung</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">lung_train</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="op">]</span>
  <span class="va">lung_test</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">bt_spec</span> <span class="op">&lt;-</span> 
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/boost_tree.html" class="external-link">boost_tree</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html" class="external-link">set_engine</a></span><span class="op">(</span><span class="st">"mboost"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_args.html" class="external-link">set_mode</a></span><span class="op">(</span><span class="st">"censored regression"</span><span class="op">)</span> 
  <span class="va">bt_spec</span></code></pre></div>
<pre><code><span class="co">## Boosted Tree Model Specification (censored regression)</span>
  <span class="co">## </span>
  <span class="co">## Main Arguments:</span>
  <span class="co">##   trees = 15</span>
  <span class="co">## </span>
  <span class="co">## Computational engine: mboost</span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="va">bt_fit</span> <span class="op">&lt;-</span> <span class="va">bt_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">lung_train</span><span class="op">)</span>
  <span class="va">bt_fit</span></code></pre></div>
<pre><code><span class="co">## parsnip model object</span>
  <span class="co">## </span>
  <span class="co">## Fit time:  130ms </span>
  <span class="co">## </span>
  <span class="co">##     Model-based Boosting</span>
  <span class="co">## </span>
  <span class="co">## Call:</span>
  <span class="co">## mboost::blackboost(formula = formula, data = data, family = family,     control = mboost::boost_control(mstop = 15), tree_controls = partykit::ctree_control(teststat = "quad",         testtype = "Teststatistic", mincriterion = 0, minsplit = 10,         minbucket = 4, maxdepth = 2, saveinfo = FALSE))</span>
  <span class="co">## </span>
  <span class="co">## </span>
  <span class="co">##     Cox Partial Likelihood </span>
  <span class="co">## </span>
  <span class="co">## Loss function:  </span>
  <span class="co">## </span>
  <span class="co">## Number of boosting iterations: mstop = 15 </span>
  <span class="co">## Step size:  0.1 </span>
  <span class="co">## Offset:  0 </span>
  <span class="co">## Number of baselearners:  1</span></code></pre>
<p>The holdout data can be predicted for survival probability at different time points as well as the linear predictor.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>
    <span class="va">bt_fit</span>, 
    <span class="va">lung_test</span>,
    type <span class="op">=</span> <span class="st">"survival"</span>,
    time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">500</span>, <span class="fl">1000</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">.pred</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 3 × 2</span></span>
  <span class="co">##   .time .pred_survival</span>
  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>   100         0.867 </span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>   500         0.294 </span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>000         0.044<span style="text-decoration: underline;">1</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bt_fit</span>, <span class="va">lung_test</span>, type <span class="op">=</span> <span class="st">"linear_pred"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 5 × 1</span></span>
  <span class="co">##   .pred_linear_pred</span>
  <span class="co">##               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>            0.082<span style="text-decoration: underline;">3</span></span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>           -<span style="color: #BB0000;">0.455</span> </span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>            0.066<span style="text-decoration: underline;">1</span></span>
  <span class="co">## <span style="color: #BCBCBC;">4</span>           -<span style="color: #BB0000;">0.724</span> </span>
  <span class="co">## <span style="color: #BCBCBC;">5</span>           -<span style="color: #BB0000;">0.724</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="decision_tree-models">
<code>decision_tree()</code> models<a class="anchor" aria-label="anchor" href="#decision_tree-models"></a>
</h2>
<details id="decision-tree-rpart"><p><summary>With the <code>"rpart"</code> engine</summary></p>
<p>We’ll model the survival of lung cancer patients.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/censored" class="external-link">censored</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span>
  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">)</span>
  
  <span class="va">lung</span> <span class="op">&lt;-</span> <span class="va">lung</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">lung_train</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="op">]</span>
  <span class="va">lung_test</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">dt_spec</span> <span class="op">&lt;-</span> 
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/decision_tree.html" class="external-link">decision_tree</a></span><span class="op">(</span>cost_complexity <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html" class="external-link">set_engine</a></span><span class="op">(</span><span class="st">"rpart"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_args.html" class="external-link">set_mode</a></span><span class="op">(</span><span class="st">"censored regression"</span><span class="op">)</span> 
  <span class="va">dt_spec</span></code></pre></div>
<pre><code><span class="co">## Decision Tree Model Specification (censored regression)</span>
  <span class="co">## </span>
  <span class="co">## Main Arguments:</span>
  <span class="co">##   cost_complexity = 0</span>
  <span class="co">## </span>
  <span class="co">## Computational engine: rpart</span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="va">dt_fit</span> <span class="op">&lt;-</span> <span class="va">dt_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">lung_train</span><span class="op">)</span>
  <span class="va">dt_fit</span></code></pre></div>
<pre><code><span class="co">## parsnip model object</span>
  <span class="co">## </span>
  <span class="co">## Fit time:  18ms </span>
  <span class="co">## $rpart</span>
  <span class="co">## n= 162 </span>
  <span class="co">## </span>
  <span class="co">## node), split, n, deviance, yval</span>
  <span class="co">##       * denotes terminal node</span>
  <span class="co">## </span>
  <span class="co">##   1) root 162 217.089100 1.0000000  </span>
  <span class="co">##     2) ph.ecog&lt; 1.5 125 146.610800 0.8606149  </span>
  <span class="co">##       4) pat.karno&gt;=65 117 134.248900 0.8042241  </span>
  <span class="co">##         8) sex&gt;=1.5 47  58.371280 0.5920010  </span>
  <span class="co">##          16) inst&gt;=12.5 16  17.696750 0.3469493 *</span>
  <span class="co">##          17) inst&lt; 12.5 31  36.986020 0.7601739  </span>
  <span class="co">##            34) ph.ecog&lt; 0.5 14  21.869860 0.4765888 *</span>
  <span class="co">##            35) ph.ecog&gt;=0.5 17  12.197510 0.9977683 *</span>
  <span class="co">##         9) sex&lt; 1.5 70  71.035080 0.9843711  </span>
  <span class="co">##          18) wt.loss&lt; -0.5 10   7.608541 0.6466464 *</span>
  <span class="co">##          19) wt.loss&gt;=-0.5 60  61.204860 1.0855380  </span>
  <span class="co">##            38) inst&lt; 18.5 51  52.890560 0.9994210  </span>
  <span class="co">##              76) pat.karno&lt; 85 27  30.835530 0.8204259  </span>
  <span class="co">##               152) age&lt; 65.5 16  16.499450 0.6396414 *</span>
  <span class="co">##               153) age&gt;=65.5 11  12.211210 1.2318540 *</span>
  <span class="co">##              77) pat.karno&gt;=85 24  20.327560 1.2436570  </span>
  <span class="co">##               154) pat.karno&gt;=95 10   6.634957 0.7568023 *</span>
  <span class="co">##               155) pat.karno&lt; 95 14  10.631990 1.6387150 *</span>
  <span class="co">##            39) inst&gt;=18.5 9   6.360874 1.6566500 *</span>
  <span class="co">##       5) pat.karno&lt; 65 8   5.011986 2.2376180 *</span>
  <span class="co">##     3) ph.ecog&gt;=1.5 37  59.992750 1.7157640  </span>
  <span class="co">##       6) wt.loss&gt;=21 10  10.703230 0.6678083 *</span>
  <span class="co">##       7) wt.loss&lt; 21 27  29.918520 3.1500170  </span>
  <span class="co">##        14) sex&gt;=1.5 12   7.395091 1.9066160 *</span>
  <span class="co">##        15) sex&lt; 1.5 15  16.563010 4.5917120 *</span>
  <span class="co">## </span>
  <span class="co">## $survfit</span>
  <span class="co">## </span>
  <span class="co">## Call: prodlim::prodlim(formula = form, data = data)</span></code></pre>
<pre><code><span class="co">## Stratified Kaplan-Meier estimator for the conditional event time survival function</span></code></pre>
<pre><code><span class="co">## Discrete predictor variable: rpartFactor (0.34694933272507, 0.47658881486553, 0.639641354557786, 0.646646427745816, 0.667808261569019, 0.756802251840104, 0.997768280401696, 1.23185367065451, 1.638714591616, 1.65664969973098, 1.90661557969861, 2.23761769770399, 4.59171172488878)</span></code></pre>
<pre><code><span class="co">## </span>
  <span class="co">## $levels</span>
  <span class="co">##  [1] "0.34694933272507"  "0.47658881486553"  "0.639641354557786"</span>
  <span class="co">##  [4] "0.646646427745816" "0.667808261569019" "0.756802251840104"</span>
  <span class="co">##  [7] "0.997768280401696" "1.23185367065451"  "1.638714591616"   </span>
  <span class="co">## [10] "1.65664969973098"  "1.90661557969861"  "2.23761769770399" </span>
  <span class="co">## [13] "4.59171172488878" </span>
  <span class="co">## </span>
  <span class="co">## attr(,"class")</span>
  <span class="co">## [1] "pecRpart"</span></code></pre>
<p>The holdout data can be predicted for survival probability at different time points as well as event time.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>
    <span class="va">dt_fit</span>, 
    <span class="va">lung_test</span>, 
    type <span class="op">=</span> <span class="st">"survival"</span>,
    time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">500</span>, <span class="fl">1000</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">.pred</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 3 × 2</span></span>
  <span class="co">##   .time .pred_survival</span>
  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>   100          0.786</span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>   500          0.143</span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>000         <span style="color: #BB0000;">NA</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dt_fit</span>, <span class="va">lung_test</span>, type <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 5 × 1</span></span>
  <span class="co">##   .pred_time</span>
  <span class="co">##        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>       1.64</span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>       2.24</span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>       1.23</span>
  <span class="co">## <span style="color: #BCBCBC;">4</span>       1.91</span>
  <span class="co">## <span style="color: #BCBCBC;">5</span>       1.91</span></code></pre>
</details><details id="decision-tree-party"><p><summary>With the <code>"party"</code> engine</summary></p>
<p>We’ll model the survival of lung cancer patients.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/censored" class="external-link">censored</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span>
  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">)</span>
  
  <span class="va">lung</span> <span class="op">&lt;-</span> <span class="va">lung</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">lung_train</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="op">]</span>
  <span class="va">lung_test</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">dt_spec</span> <span class="op">&lt;-</span> 
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/decision_tree.html" class="external-link">decision_tree</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html" class="external-link">set_engine</a></span><span class="op">(</span><span class="st">"party"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_args.html" class="external-link">set_mode</a></span><span class="op">(</span><span class="st">"censored regression"</span><span class="op">)</span> 
  <span class="va">dt_spec</span></code></pre></div>
<pre><code><span class="co">## Decision Tree Model Specification (censored regression)</span>
  <span class="co">## </span>
  <span class="co">## Computational engine: party</span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="va">dt_fit</span> <span class="op">&lt;-</span> <span class="va">dt_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">lung_train</span><span class="op">)</span>
  <span class="va">dt_fit</span></code></pre></div>
<pre><code><span class="co">## parsnip model object</span>
  <span class="co">## </span>
  <span class="co">## Fit time:  216ms </span>
  <span class="co">## </span>
  <span class="co">##     Conditional inference tree with 4 terminal nodes</span>
  <span class="co">## </span>
  <span class="co">## Response:  Surv(time, status) </span>
  <span class="co">## Inputs:  inst, age, sex, ph.ecog, ph.karno, pat.karno, meal.cal, wt.loss </span>
  <span class="co">## Number of observations:  162 </span>
  <span class="co">## </span>
  <span class="co">## 1) ph.ecog &lt;= 1; criterion = 0.994, statistic = 11.294</span>
  <span class="co">##   2)*  weights = 125 </span>
  <span class="co">## 1) ph.ecog &gt; 1</span>
  <span class="co">##   3) wt.loss &lt;= 20; criterion = 0.962, statistic = 7.946</span>
  <span class="co">##     4) sex &lt;= 1; criterion = 0.965, statistic = 8.113</span>
  <span class="co">##       5)*  weights = 15 </span>
  <span class="co">##     4) sex &gt; 1</span>
  <span class="co">##       6)*  weights = 12 </span>
  <span class="co">##   3) wt.loss &gt; 20</span>
  <span class="co">##     7)*  weights = 10</span></code></pre>
<p>The holdout data can be predicted for survival probability at different time points as well as event time.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>
    <span class="va">dt_fit</span>, 
    <span class="va">lung_test</span>, 
    type <span class="op">=</span> <span class="st">"survival"</span>,
    time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">500</span>, <span class="fl">1000</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">.pred</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 3 × 4</span></span>
  <span class="co">##   .time .pred_survival .pred_survival_lower .pred_survival_upper</span>
  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>   100         0.896                0.844                 0.951</span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>   500         0.334                0.248                 0.451</span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>000         0.071<span style="text-decoration: underline;">9</span>               0.029<span style="text-decoration: underline;">7</span>                0.174</span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dt_fit</span>, <span class="va">lung_test</span>, type <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 5 × 1</span></span>
  <span class="co">##   .pred_time</span>
  <span class="co">##        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>        363</span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>        363</span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>        363</span>
  <span class="co">## <span style="color: #BCBCBC;">4</span>        201</span>
  <span class="co">## <span style="color: #BCBCBC;">5</span>        201</span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="proportional_hazards-models">
<code>proportional_hazards()</code> models<a class="anchor" aria-label="anchor" href="#proportional_hazards-models"></a>
</h2>
<details id="proportional-hazards-survival"><p><summary>With the <code>"survival"</code> engine</summary></p>
<p>We’ll model the survival of lung cancer patients.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/censored" class="external-link">censored</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span>
  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">)</span>
  
  <span class="va">lung</span> <span class="op">&lt;-</span> <span class="va">lung</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">lung_train</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="op">]</span>
  <span class="va">lung_test</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">ph_spec</span> <span class="op">&lt;-</span> 
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/proportional_hazards.html" class="external-link">proportional_hazards</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html" class="external-link">set_engine</a></span><span class="op">(</span><span class="st">"survival"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_args.html" class="external-link">set_mode</a></span><span class="op">(</span><span class="st">"censored regression"</span><span class="op">)</span> 
  <span class="va">ph_spec</span></code></pre></div>
<pre><code><span class="co">## Proportional Hazards Model Specification (censored regression)</span>
  <span class="co">## </span>
  <span class="co">## Computational engine: survival</span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="va">ph_fit</span> <span class="op">&lt;-</span> <span class="va">ph_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">lung_train</span><span class="op">)</span>
  <span class="va">ph_fit</span></code></pre></div>
<pre><code><span class="co">## parsnip model object</span>
  <span class="co">## </span>
  <span class="co">## Fit time:  10ms </span>
  <span class="co">## Call:</span>
  <span class="co">## survival::coxph(formula = Surv(time, status) ~ ., data = data, </span>
  <span class="co">##     model = TRUE, x = TRUE)</span>
  <span class="co">## </span>
  <span class="co">##                 coef  exp(coef)   se(coef)      z       p</span>
  <span class="co">## inst      -0.0291726  0.9712488  0.0131293 -2.222 0.02629</span>
  <span class="co">## age        0.0146341  1.0147417  0.0119705  1.223 0.22151</span>
  <span class="co">## sex       -0.5977137  0.5500678  0.2051326 -2.914 0.00357</span>
  <span class="co">## ph.ecog    0.7507039  2.1184906  0.2536100  2.960 0.00308</span>
  <span class="co">## ph.karno   0.0137315  1.0138262  0.0132752  1.034 0.30096</span>
  <span class="co">## pat.karno -0.0082098  0.9918238  0.0082560 -0.994 0.32002</span>
  <span class="co">## meal.cal  -0.0001233  0.9998767  0.0002841 -0.434 0.66435</span>
  <span class="co">## wt.loss   -0.0188464  0.9813301  0.0082051 -2.297 0.02162</span>
  <span class="co">## </span>
  <span class="co">## Likelihood ratio test=32.61  on 8 df, p=7.224e-05</span>
  <span class="co">## n= 162, number of events= 116</span></code></pre>
<p>The holdout data can be predicted for survival probability at different time points as well as the linear predictor and event time.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>
    <span class="va">ph_fit</span>, 
    <span class="va">lung_test</span>, 
    type <span class="op">=</span> <span class="st">"survival"</span>,
    time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">500</span>, <span class="fl">1000</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">.pred</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 3 × 2</span></span>
  <span class="co">##   .time .pred_survival</span>
  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>   100         0.903 </span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>   500         0.410 </span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>000         0.095<span style="text-decoration: underline;">3</span></span></code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ph_fit</span>, <span class="va">lung_test</span>, type <span class="op">=</span> <span class="st">"linear_pred"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 5 × 1</span></span>
  <span class="co">##   .pred_linear_pred</span>
  <span class="co">##               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>            -<span style="color: #BB0000;">0.373</span></span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>            -<span style="color: #BB0000;">1.24</span> </span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>            -<span style="color: #BB0000;">0.852</span></span>
  <span class="co">## <span style="color: #BCBCBC;">4</span>            -<span style="color: #BB0000;">1.33</span> </span>
  <span class="co">## <span style="color: #BCBCBC;">5</span>            -<span style="color: #BB0000;">1.11</span></span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ph_fit</span>, <span class="va">lung_test</span>, type <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 5 × 1</span></span>
  <span class="co">##   .pred_time</span>
  <span class="co">##        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>       448.</span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>       262.</span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>       337.</span>
  <span class="co">## <span style="color: #BCBCBC;">4</span>       246.</span>
  <span class="co">## <span style="color: #BCBCBC;">5</span>       286.</span></code></pre>
</details><details id="proportional-hazards-glmnet"><p><summary>With the <code>"glmnet"</code> engine</summary></p>
<p>We’ll model the survival of lung cancer patients.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/censored" class="external-link">censored</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span>
  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">)</span>
  
  <span class="va">lung</span> <span class="op">&lt;-</span> <span class="va">lung</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">lung_train</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="op">]</span>
  <span class="va">lung_test</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">ph_spec</span> <span class="op">&lt;-</span> 
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/proportional_hazards.html" class="external-link">proportional_hazards</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html" class="external-link">set_engine</a></span><span class="op">(</span><span class="st">"glmnet"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_args.html" class="external-link">set_mode</a></span><span class="op">(</span><span class="st">"censored regression"</span><span class="op">)</span> 
  <span class="va">ph_spec</span></code></pre></div>
<pre><code><span class="co">## Proportional Hazards Model Specification (censored regression)</span>
  <span class="co">## </span>
  <span class="co">## Main Arguments:</span>
  <span class="co">##   penalty = 0.1</span>
  <span class="co">## </span>
  <span class="co">## Computational engine: glmnet</span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="va">ph_fit</span> <span class="op">&lt;-</span> <span class="va">ph_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">lung_train</span><span class="op">)</span>
  <span class="va">ph_fit</span></code></pre></div>
<pre><code><span class="co">## parsnip model object</span>
  <span class="co">## </span>
  <span class="co">## Fit time:  16ms </span>
  <span class="co">## </span>
  <span class="co">## Call:  glmnet::glmnet(x = data_obj$x, y = data_obj$y, family = "cox",      alpha = alpha, lambda = lambda) </span>
  <span class="co">## </span>
  <span class="co">##    Df %Dev   Lambda</span>
  <span class="co">## 1   0 0.00 0.221000</span>
  <span class="co">## 2   1 0.23 0.201400</span>
  <span class="co">## 3   2 0.43 0.183500</span>
  <span class="co">## 4   2 0.72 0.167200</span>
  <span class="co">## 5   2 0.96 0.152300</span>
  <span class="co">## 6   2 1.17 0.138800</span>
  <span class="co">## 7   2 1.33 0.126500</span>
  <span class="co">## 8   3 1.48 0.115200</span>
  <span class="co">## 9   4 1.61 0.105000</span>
  <span class="co">## 10  4 1.74 0.095660</span>
  <span class="co">## 11  5 1.87 0.087160</span>
  <span class="co">## 12  6 2.02 0.079420</span>
  <span class="co">## 13  6 2.22 0.072370</span>
  <span class="co">## 14  6 2.40 0.065940</span>
  <span class="co">## 15  6 2.54 0.060080</span>
  <span class="co">## 16  6 2.66 0.054740</span>
  <span class="co">## 17  6 2.77 0.049880</span>
  <span class="co">## 18  6 2.85 0.045450</span>
  <span class="co">## 19  6 2.92 0.041410</span>
  <span class="co">## 20  6 2.98 0.037730</span>
  <span class="co">## 21  7 3.04 0.034380</span>
  <span class="co">## 22  7 3.08 0.031330</span>
  <span class="co">## 23  7 3.12 0.028540</span>
  <span class="co">## 24  7 3.16 0.026010</span>
  <span class="co">## 25  7 3.19 0.023700</span>
  <span class="co">## 26  7 3.21 0.021590</span>
  <span class="co">## 27  8 3.23 0.019670</span>
  <span class="co">## 28  8 3.27 0.017930</span>
  <span class="co">## 29  8 3.30 0.016330</span>
  <span class="co">## 30  8 3.32 0.014880</span>
  <span class="co">## 31  8 3.34 0.013560</span>
  <span class="co">## 32  8 3.36 0.012360</span>
  <span class="co">## 33  8 3.37 0.011260</span>
  <span class="co">## 34  8 3.39 0.010260</span>
  <span class="co">## 35  8 3.40 0.009346</span>
  <span class="co">## 36  8 3.40 0.008516</span>
  <span class="co">## 37  8 3.41 0.007760</span>
  <span class="co">## 38  8 3.42 0.007070</span>
  <span class="co">## 39  8 3.42 0.006442</span>
  <span class="co">## 40  8 3.43 0.005870</span>
  <span class="co">## 41  8 3.43 0.005348</span>
  <span class="co">## 42  8 3.43 0.004873</span>
  <span class="co">## 43  8 3.43 0.004440</span>
  <span class="co">## 44  8 3.44 0.004046</span>
  <span class="co">## 45  8 3.44 0.003686</span>
  <span class="co">## 46  8 3.44 0.003359</span>
  <span class="co">## 47  8 3.44 0.003061</span>
  <span class="co">## 48  8 3.44 0.002789</span>
  <span class="co">## 49  8 3.44 0.002541</span>
  <span class="co">## 50  8 3.44 0.002315</span>
  <span class="co">## The training data has been saved for prediction.</span></code></pre>
<p>The holdout data can be predicted for survival probability at different time points as well as the linear predictor.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>
    <span class="va">ph_fit</span>, 
    <span class="va">lung_test</span>, 
    type <span class="op">=</span> <span class="st">"survival"</span>,
    time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">500</span>, <span class="fl">1000</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">.pred</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 3 × 2</span></span>
  <span class="co">##   .time .pred_survival</span>
  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>   100         0.874 </span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>   500         0.349 </span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>000         0.080<span style="text-decoration: underline;">4</span></span></code></pre>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ph_fit</span>, <span class="va">lung_test</span>, type <span class="op">=</span> <span class="st">"linear_pred"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 5 × 1</span></span>
  <span class="co">##   .pred_linear_pred</span>
  <span class="co">##               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>         0.272    </span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>         0.000<span style="text-decoration: underline;">079</span>8</span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>         0.005<span style="text-decoration: underline;">75</span>  </span>
  <span class="co">## <span style="color: #BCBCBC;">4</span>        -<span style="color: #BB0000;">0.021</span><span style="color: #BB0000; text-decoration: underline;">1</span>   </span>
  <span class="co">## <span style="color: #BCBCBC;">5</span>        -<span style="color: #BB0000;">0.003</span><span style="color: #BB0000; text-decoration: underline;">45</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="rand_forest-models">
<code>rand_forest()</code> models<a class="anchor" aria-label="anchor" href="#rand_forest-models"></a>
</h2>
<details id="rand-forest-party"><p><summary>With the <code>"party"</code> engine</summary></p>
<p>We’ll model the survival of lung cancer patients.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/censored" class="external-link">censored</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span>
  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">)</span>
  
  <span class="va">lung</span> <span class="op">&lt;-</span> <span class="va">lung</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">lung_train</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="op">]</span>
  <span class="va">lung_test</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">rf_spec</span> <span class="op">&lt;-</span> 
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/rand_forest.html" class="external-link">rand_forest</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">200</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html" class="external-link">set_engine</a></span><span class="op">(</span><span class="st">"party"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_args.html" class="external-link">set_mode</a></span><span class="op">(</span><span class="st">"censored regression"</span><span class="op">)</span> 
  <span class="va">rf_spec</span></code></pre></div>
<pre><code><span class="co">## Random Forest Model Specification (censored regression)</span>
  <span class="co">## </span>
  <span class="co">## Main Arguments:</span>
  <span class="co">##   trees = 200</span>
  <span class="co">## </span>
  <span class="co">## Computational engine: party</span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="va">rf_fit</span> <span class="op">&lt;-</span> <span class="va">rf_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">lung_train</span><span class="op">)</span>
  <span class="va">rf_fit</span></code></pre></div>
<pre><code><span class="co">## parsnip model object</span>
  <span class="co">## </span>
  <span class="co">## Fit time:  87ms </span>
  <span class="co">## </span>
  <span class="co">##     Random Forest using Conditional Inference Trees</span>
  <span class="co">## </span>
  <span class="co">## Number of trees:  200 </span>
  <span class="co">## </span>
  <span class="co">## Response:  Surv(time, status) </span>
  <span class="co">## Inputs:  inst, age, sex, ph.ecog, ph.karno, pat.karno, meal.cal, wt.loss </span>
  <span class="co">## Number of observations:  162</span></code></pre>
<p>The holdout data can be predicted for survival probability at different time points as well as event time.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>
    <span class="va">rf_fit</span>, 
    <span class="va">lung_test</span>, 
    type <span class="op">=</span> <span class="st">"survival"</span>, 
    time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">500</span>, <span class="fl">1000</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">.pred</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 3 × 4</span></span>
  <span class="co">##   .time .pred_survival .pred_survival_lower .pred_survival_upper</span>
  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>   100         0.894               0.826                  0.967</span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>   500         0.321               0.203                  0.506</span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>000         0.038<span style="text-decoration: underline;">2</span>              0.007<span style="text-decoration: underline;">30</span>                0.200</span></code></pre>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">rf_fit</span>, <span class="va">lung_test</span>, type <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 5 × 1</span></span>
  <span class="co">##   .pred_time</span>
  <span class="co">##        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>        348</span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>        246</span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>        239</span>
  <span class="co">## <span style="color: #BCBCBC;">4</span>        199</span>
  <span class="co">## <span style="color: #BCBCBC;">5</span>        212</span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="survival_reg-models">
<code>survival_reg()</code> models<a class="anchor" aria-label="anchor" href="#survival_reg-models"></a>
</h2>
<details id="survival-reg-survival"><p><summary>With the <code>"survival"</code> engine</summary></p>
<p>We’ll model the survival of lung cancer patients.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/censored" class="external-link">censored</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span>
  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">)</span>
  
  <span class="va">lung</span> <span class="op">&lt;-</span> <span class="va">lung</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">lung_train</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="op">]</span>
  <span class="va">lung_test</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">sr_spec</span> <span class="op">&lt;-</span> 
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/survival_reg.html" class="external-link">survival_reg</a></span><span class="op">(</span>dist <span class="op">=</span> <span class="st">"weibull"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html" class="external-link">set_engine</a></span><span class="op">(</span><span class="st">"survival"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_args.html" class="external-link">set_mode</a></span><span class="op">(</span><span class="st">"censored regression"</span><span class="op">)</span> 
  <span class="va">sr_spec</span></code></pre></div>
<pre><code><span class="co">## Parametric Survival Regression Model Specification (censored regression)</span>
  <span class="co">## </span>
  <span class="co">## Main Arguments:</span>
  <span class="co">##   dist = weibull</span>
  <span class="co">## </span>
  <span class="co">## Computational engine: survival</span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="va">sr_fit</span> <span class="op">&lt;-</span> <span class="va">sr_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">lung_train</span><span class="op">)</span>
  <span class="va">sr_fit</span></code></pre></div>
<pre><code><span class="co">## parsnip model object</span>
  <span class="co">## </span>
  <span class="co">## Fit time:  7ms </span>
  <span class="co">## Call:</span>
  <span class="co">## survival::survreg(formula = Surv(time, status) ~ ., data = data, </span>
  <span class="co">##     dist = ~"weibull", model = TRUE)</span>
  <span class="co">## </span>
  <span class="co">## Coefficients:</span>
  <span class="co">##   (Intercept)          inst           age           sex       ph.ecog </span>
  <span class="co">##  6.2802499155  0.0191302849 -0.0085917372  0.4249655608 -0.5022975982 </span>
  <span class="co">##      ph.karno     pat.karno      meal.cal       wt.loss </span>
  <span class="co">## -0.0085852225  0.0058753359  0.0001003211  0.0127001420 </span>
  <span class="co">## </span>
  <span class="co">## Scale= 0.6902035 </span>
  <span class="co">## </span>
  <span class="co">## Loglik(model)= -795.2   Loglik(intercept only)= -811.4</span>
  <span class="co">##    Chisq= 32.41 on 8 degrees of freedom, p= 7.85e-05 </span>
  <span class="co">## n= 162</span></code></pre>
<p>The holdout data can be predicted for survival probability at different time points as well as event time, quantile, and hazard.</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>
    <span class="va">sr_fit</span>, 
    <span class="va">lung_test</span>, 
    type <span class="op">=</span> <span class="st">"survival"</span>,
    time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">500</span>, <span class="fl">1000</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">.pred</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 3 × 2</span></span>
  <span class="co">##   .time .pred_survival</span>
  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>   100         0.912 </span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>   500         0.386 </span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>000         0.074<span style="text-decoration: underline;">2</span></span></code></pre>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">sr_fit</span>, <span class="va">lung_test</span>, type <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 5 × 1</span></span>
  <span class="co">##   .pred_time</span>
  <span class="co">##        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>       517.</span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>       283.</span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>       361.</span>
  <span class="co">## <span style="color: #BCBCBC;">4</span>       268.</span>
  <span class="co">## <span style="color: #BCBCBC;">5</span>       313.</span></code></pre>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">sr_fit</span>, <span class="va">lung_test</span>, type <span class="op">=</span> <span class="st">"quantile"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">.pred</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 9 × 2</span></span>
  <span class="co">##   .pred .quantile</span>
  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>  109.       0.1</span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>  184.       0.2</span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>  254.       0.3</span>
  <span class="co">## <span style="color: #BCBCBC;">4</span>  325.       0.4</span>
  <span class="co">## <span style="color: #BCBCBC;">5</span>  401.       0.5</span>
  <span class="co">## <span style="color: #BCBCBC;">6</span>  487.       0.6</span>
  <span class="co">## <span style="color: #BCBCBC;">7</span>  588.       0.7</span>
  <span class="co">## <span style="color: #BCBCBC;">8</span>  718.       0.8</span>
  <span class="co">## <span style="color: #BCBCBC;">9</span>  919.       0.9</span></code></pre>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">sr_fit</span>, <span class="va">lung_test</span>, type <span class="op">=</span> <span class="st">"hazard"</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">500</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">.pred</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 3 × 2</span></span>
  <span class="co">##   .time .pred_hazard</span>
  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>   100      0.001<span style="text-decoration: underline;">34</span></span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>   500      0.002<span style="text-decoration: underline;">76</span></span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>000      0.003<span style="text-decoration: underline;">77</span></span></code></pre>
</details><details id="survival-reg-flexsurv"><p><summary>With the <code>"flexsurv"</code> engine</summary></p>
<p>We’ll model the survival of lung cancer patients.</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/censored" class="external-link">censored</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span>
  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">)</span>
  
  <span class="va">lung</span> <span class="op">&lt;-</span> <span class="va">lung</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">lung_train</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="op">]</span>
  <span class="va">lung_test</span> <span class="op">&lt;-</span> <span class="va">lung</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">sr_spec</span> <span class="op">&lt;-</span> 
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/survival_reg.html" class="external-link">survival_reg</a></span><span class="op">(</span>dist <span class="op">=</span> <span class="st">"weibull"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html" class="external-link">set_engine</a></span><span class="op">(</span><span class="st">"flexsurv"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_args.html" class="external-link">set_mode</a></span><span class="op">(</span><span class="st">"censored regression"</span><span class="op">)</span> 
  <span class="va">sr_spec</span></code></pre></div>
<pre><code><span class="co">## Parametric Survival Regression Model Specification (censored regression)</span>
  <span class="co">## </span>
  <span class="co">## Main Arguments:</span>
  <span class="co">##   dist = weibull</span>
  <span class="co">## </span>
  <span class="co">## Computational engine: flexsurv</span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="va">sr_fit</span> <span class="op">&lt;-</span> <span class="va">sr_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">ph.ecog</span>, data <span class="op">=</span> <span class="va">lung_train</span><span class="op">)</span>
  <span class="va">sr_fit</span></code></pre></div>
<pre><code><span class="co">## parsnip model object</span>
  <span class="co">## </span>
  <span class="co">## Fit time:  91ms </span>
  <span class="co">## Call:</span>
  <span class="co">## flexsurv::flexsurvreg(formula = Surv(time, status) ~ age + sex + </span>
  <span class="co">##     ph.ecog, data = data, dist = ~"weibull")</span>
  <span class="co">## </span>
  <span class="co">## Estimates: </span>
  <span class="co">##          data mean  est        L95%       U95%       se         exp(est) </span>
  <span class="co">## shape           NA   1.39e+00   1.21e+00   1.61e+00   1.02e-01         NA</span>
  <span class="co">## scale           NA   5.74e+02   1.99e+02   1.65e+03   3.10e+02         NA</span>
  <span class="co">## age       6.24e+01  -9.02e-03  -2.50e-02   6.93e-03   8.14e-03   9.91e-01</span>
  <span class="co">## sex       1.38e+00   4.02e-01   1.17e-01   6.87e-01   1.45e-01   1.50e+00</span>
  <span class="co">## ph.ecog   9.51e-01  -3.17e-01  -5.13e-01  -1.21e-01   1.00e-01   7.28e-01</span>
  <span class="co">##          L95%       U95%     </span>
  <span class="co">## shape           NA         NA</span>
  <span class="co">## scale           NA         NA</span>
  <span class="co">## age       9.75e-01   1.01e+00</span>
  <span class="co">## sex       1.12e+00   1.99e+00</span>
  <span class="co">## ph.ecog   5.99e-01   8.86e-01</span>
  <span class="co">## </span>
  <span class="co">## N = 162,  Events: 116,  Censored: 46</span>
  <span class="co">## Total time at risk: 49401</span>
  <span class="co">## Log-likelihood = -800.356, df = 5</span>
  <span class="co">## AIC = 1610.712</span></code></pre>
<p>The holdout data can be predicted for survival probability at different time points as well as event time, quantile, and hazard.</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>
    <span class="va">sr_fit</span>, 
    <span class="va">lung_test</span>, 
    type <span class="op">=</span> <span class="st">"survival"</span>,
    time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">500</span>, <span class="fl">1000</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">.pred</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 3 × 2</span></span>
  <span class="co">##   .time .pred_survival</span>
  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>   100         0.889 </span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>   500         0.330 </span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>000         0.054<span style="text-decoration: underline;">3</span></span></code></pre>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">sr_fit</span>, <span class="va">lung_test</span>, type <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 5 × 1</span></span>
  <span class="co">##   .pred_time</span>
  <span class="co">##        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>       424.</span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>       341.</span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>       292.</span>
  <span class="co">## <span style="color: #BCBCBC;">4</span>       336.</span>
  <span class="co">## <span style="color: #BCBCBC;">5</span>       327.</span></code></pre>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">sr_fit</span>, <span class="va">lung_test</span>, type <span class="op">=</span> <span class="st">"quantile"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">.pred</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 9 × 4</span></span>
  <span class="co">##   .quantile .pred_quantile .pred_quantile_lower .pred_quantile_upper</span>
  <span class="co">##       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>       0.1           92.5                 62.8                 130.</span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>       0.2          158.                 113.                  216.</span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>       0.3          222.                 162.                  297.</span>
  <span class="co">## <span style="color: #BCBCBC;">4</span>       0.4          287.                 211.                  386.</span>
  <span class="co">## <span style="color: #BCBCBC;">5</span>       0.5          357.                 265.                  486.</span>
  <span class="co">## <span style="color: #BCBCBC;">6</span>       0.6          436.                 326.                  593.</span>
  <span class="co">## <span style="color: #BCBCBC;">7</span>       0.7          531.                 394.                  725.</span>
  <span class="co">## <span style="color: #BCBCBC;">8</span>       0.8          653.                 482.                  896.</span>
  <span class="co">## <span style="color: #BCBCBC;">9</span>       0.9          845.                 618.                 <span style="text-decoration: underline;">1</span>164.</span></code></pre>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">sr_fit</span>, <span class="va">lung_test</span>, type <span class="op">=</span> <span class="st">"hazard"</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">500</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">.pred</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 3 × 2</span></span>
  <span class="co">##   .time .pred_hazard</span>
  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
  <span class="co">## <span style="color: #BCBCBC;">1</span>   100      0.001<span style="text-decoration: underline;">64</span></span>
  <span class="co">## <span style="color: #BCBCBC;">2</span>   500      0.003<span style="text-decoration: underline;">09</span></span>
  <span class="co">## <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>000      0.004<span style="text-decoration: underline;">06</span></span></code></pre>
</details>
</div>
  </div>
 <div class="col-md-3" id="pkgdown-sidebar">
        <nav id="toc"><h2>On this page</h2>
    </nav>
</div>

</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Emil Hvitfeldt, <a href="https://frick.ws" class="external-link">Hannah Frick</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

  </div></footer>
</body>
</html>
